# Pipeline for Generating NumPy Operations JSON Files

This document outlines the step-by-step process for generating comprehensive NumPy operations documentation in JSON format.

## Overview

The goal is to create structured JSON files containing NumPy function documentation, including names, descriptions, URLs, full documentation, and code references.

## Step-by-Step Pipeline

### 1. Initial Request - Identify Target Functions and Gather Function Lists

**Prompt:**
```
Use the browsermcp tool to search for all numpy dense matrix linalg operations such as diagonal, transpose and etc. available. Make a list of them in web_utils/basic_ops.json, just the names and urls to the exisiting documentation, leave the in-depth investigation later.
```

### 2. Create Initial JSON Structure

**Prompt:**
```
, e.g. in the json file, the add should look like : "add": {"doc": some doc,  "code": some code(ALL the code with definition and impl, not just a function head)}, remember, grab all the functions in the list
"For each function, create a JSON entry with these fields:
{
  "name": "numpy.linalg.function_name",
  "description": "Brief one-line description",
  "url": "Official NumPy documentation URL",
  "doc": "Full documentation string with parameters, returns, examples",
  "code": "Implementation or reference to source"
  }
}"
```

### 4. Fetch Documentation

**Prompt:**
```
"For each function, fetch:
1. The complete docstring from NumPy documentation
2. Parameter descriptions with types
3. Return value descriptions
4. Usage examples
5. Any important notes or warnings"
```

### 5. Fetch Source Code

**Prompt:**
```
"For functions with Python implementations, fetch the actual source code from GitHub.
For C-implemented functions, note that they are 'C implementation' with a reference.
Use the GitHub URLs like: https://github.com/numpy/numpy/blob/v2.3.0/numpy/linalg/_linalg.py#L2888-L3005"
```

### 6. Handle Multiple Files

**Initial approach (if needed):**
```
"Create separate JSON files for each category:
- matrix_vector_products.json
- decompositions.json
- eigenvalues.json
- norms.json
- solving_equations.json
- other_ops.json"
```

### 7. Merge and Unify Format

**Prompt:**
```
"Merge all individual JSON files into a single comprehensive file with this structure:
{
  "numpy_linalg_operations": {
    "category_name": [array of functions],
    ...
  },
  "metadata": {
    "total_functions": N,
    "categories": M,
    "generated_date": "YYYY-MM-DD",
    "source": "NumPy v2.3 documentation and GitHub repository"
  }
}"
```

### 8. Fix Incomplete Entries

**Prompt:**
```
"Check for any entries where 'code' contains just a URL or reference.
For these, fetch the actual code from the GitHub URLs provided.
For C implementations, keep the reference but make it clear."
```

### 9. Flatten Nested Structure

**Prompt:**
```
"Transform the JSON to remove the nested 'add' field and create a flat structure:
{
  "name": "...",
  "description": "...",
  "url": "...",
  "doc": "...",
  "code": "..."
}"
```

### 10. Clean Up

**Prompt:**
```
"Remove all draft files and temporary scripts.
Keep only the final unified JSON files in web_utils/output/"
```

## Key Tips for Better Results

1. **Be Specific**: Specify exact module names (numpy.linalg, numpy, etc.)
2. **Request Categories**: Ask for logical grouping of functions
3. **Define Format Early**: Provide the exact JSON structure you want
4. **Iterative Refinement**: Don't expect perfect results in one go
5. **Verify Completeness**: Ask to check total function count against NumPy docs
6. **Handle Edge Cases**: Be prepared for C implementations, aliases, deprecated functions

## Common Issues and Solutions

- **Incomplete Code**: Many NumPy functions are C implementations - accept references instead of full code
- **Nested Structures**: Explicitly request flat structure if that's what you need
- **Missing Documentation**: Some functions may need manual documentation fetching
- **Format Consistency**: May need a final pass to ensure all entries follow the same format

## Example Final Output Structure

```json
{
  "numpy_linalg_operations": {
    "matrix_vector_products": [
      {
        "name": "numpy.dot",
        "description": "Dot product of two arrays",
        "url": "https://numpy.org/doc/stable/reference/generated/numpy.dot.html",
        "doc": "Complete documentation...",
        "code": "Implementation or reference..."
      }
    ]
  },
  "metadata": {
    "total_functions": 46,
    "categories": 6,
    "generated_date": "2024-XX-XX",
    "source": "NumPy v2.3 documentation and GitHub repository"
  }
}
```

## Validation Checklist

- [ ] All functions have complete documentation
- [ ] URLs are valid and point to official NumPy docs
- [ ] Categories make logical sense
- [ ] Metadata is accurate
- [ ] File follows consistent formatting
- [ ] No duplicate entries
- [ ] Appropriate handling of C vs Python implementations